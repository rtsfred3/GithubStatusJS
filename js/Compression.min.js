class Compression{static concatUint8Arrays(e,t){var s=new Uint8Array(e.byteLength+t.byteLength);return s.set(e,0),s.set(t,e.length),s}static async Compress(e,t="gzip"){const s=(new TextEncoder).encode(e);return this.CompressChunk(s,t)}static async CompressJson(e,t="gzip"){return await this.Compress(JSON.stringify(e),t)}static async CompressFile(e,t="gzip"){var s=await e.arrayBuffer(),a=new Uint8Array(s),n="gzip"==t?".gz":"",r=e.type;"gzip"==t&&(r="application/gzip");const i=await this.CompressChunk(a,t);return new File([i],`${e.name}${n}`,{type:r})}static CompressAndDownloadJson(e,t="compressed.json"){const s=this.JsonFile(e,t);this.CompressFile(s,"gzip").then((e=>this.DownloadFile(e)))}static async CompressChunk(e,t="gzip"){const s=new CompressionStream(t),a=s.writable.getWriter();a.write(e),a.close();const n=await new Response(s.readable).arrayBuffer();return new Uint8Array(n)}static async Decompress(e,t="gzip"){e instanceof Uint8Array&&(e=e.buffer);var s=await this.DecompressChunk(e,t);return(new TextDecoder).decode(s)}static async DecompressJson(e,t="gzip"){const s=await this.Decompress(e,t);return JSON.parse(s)}static async DecompressFile(e,t=void 0,s="text/plain",a="gzip"){const n=await this.ReadCompressedReadableStream(e.stream()),r=await this.DecompressChunk(n,a);return null==t&&(t=t.endsWith(".gz")?e.name.replace(".gz",""):"output"),t.endsWith(".json")&&(s="application/json"),new File([r],t,{type:s})}static async ReadCompressedReadableStream(e){let t=new Uint8Array(0);const s=e.getReader();let a=await s.read();for(;!a.done;)t=this.concatUint8Arrays(t,a.value),a=await s.read();return t.buffer}static async DecompressChunk(e,t="gzip"){const s=new DecompressionStream(t),a=s.writable.getWriter();return a.write(e),a.close(),await new Response(s.readable).arrayBuffer()}static DownloadArrayBuffer(e,t,s="application/gzip"){const a=new Blob([e],{type:s});this.DownloadBlob(a,t)}static DownloadFile(e){this.DownloadBlob(e,e.name)}static DownloadBlob(e,t){var s=document.createElement("a");s.download=t,s.href=window.URL.createObjectURL(e),document.body.appendChild(s),s.click(),s.remove()}}