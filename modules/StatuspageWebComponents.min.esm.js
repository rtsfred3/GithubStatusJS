import StatuspageDictionary from"./StatuspageDictionary.esm.js";export default class StatuspageWebComponents{static get CustomHTMLElement(){return class extends HTMLElement{constructor(){super()}get parentElementTag(){return null!=this.parentElement?this.parentElement.tagName.toLowerCase():null}get isInSummary(){return this.parentElementTag==StatuspageWebComponents.Summary.is.toLowerCase()}get summaryJson(){return this.isInSummary?this.parentElement.dataJson:null}}}static get App(){return class extends HTMLElement{constructor(){super()}connectedCallback(){if(console.log(`Starting ${StatuspageWebComponents.App.is}`),this.id="app",this.appendChild(StatuspageWebComponents.Loading.toHTML()),this.hasAttribute("data-url"))if(this.url=this.getAttribute("data-url"),this.removeAttribute("data-url"),location.pathname==StatuspageDictionary.Paths.Index)StatuspageHTMLElements.UpdateUrlTags(location.href),(e=document.createElement(StatuspageWebComponents.Summary.is,{is:StatuspageWebComponents.Summary.is})).baseUrl=this.url,e.isSingleRequest=!0,this.firstElementChild.replaceWith(e);else if(location.pathname==StatuspageDictionary.Paths.Components||location.pathname.endsWith(StatuspageDictionary.Paths.Components)){StatuspageHTMLElements.UpdateUrlTags(location.href);var t=document.createElement(StatuspageWebComponents.Components.is,{is:StatuspageWebComponents.Components.is});t.setAttribute("data-url",this.url),this.firstElementChild.replaceWith(t)}else if(location.pathname==StatuspageDictionary.Paths.Status||location.pathname.endsWith(StatuspageDictionary.Paths.Status)){var s=document.createElement(StatuspageWebComponents.Status.is,{is:StatuspageWebComponents.Status.is});s.baseUrl=this.url,s.fullScreen=!0,this.firstElementChild.replaceWith(s)}else{var e;StatuspageHTMLElements.UpdateUrlTags(location.href),(e=document.createElement(StatuspageWebComponents.Summary.is,{is:StatuspageWebComponents.Summary.is})).baseUrl=this.url,e.isSingleRequest=!0,this.removeChild(this.firstChild),this.appendChild(e)}console.log(`Finished ${StatuspageWebComponents.App.is}`)}toString(){return this.outerHTML.toString()}static get is(){return StatuspageDictionary.HTMLTags.StatuspageApp}}}static get StatusElement(){return class extends HTMLElement{constructor(t){super(),this.status=t}connectedCallback(){StatuspageHTMLElements.SetThemeColor(this.status)}toString(){return this.outerHTML.toString()}static get is(){return StatuspageDictionary.HTMLTags.StatusElement}static toHTML(){return document.createElement(this.is,{is:this.is})}static toString(){return`<${this.is}></${this.is}>`}}}static get Error(){return class extends StatuspageWebComponents.StatusElement{constructor(){super(StatuspageDictionary.StatusEnums.error)}static get is(){return StatuspageDictionary.HTMLTags.StatuspageError}}}static get Loading(){return class extends StatuspageWebComponents.StatusElement{constructor(){super(StatuspageDictionary.StatusEnums.loading)}static get is(){return StatuspageDictionary.HTMLTags.StatuspageLoading}}}static get Unavailable(){return class extends StatuspageWebComponents.StatusElement{constructor(){super(StatuspageDictionary.StatusEnums.unavailable)}static get is(){return StatuspageDictionary.HTMLTags.StatuspageUnavailable}}}static get Status(){return class extends StatuspageWebComponents.CustomHTMLElement{static get observedAttributes(){return["data-status","data-url","status","fullscreen"]}set isLoading(t){"boolean"==typeof t&&this.data._isLoadingEnabled&&(this.data._isLoading=t,this.data._isLoading||(null!=this.data._status?this.setAttribute("data-status",this.data._status):null==this.data._status&&this.removeAttribute("data-status"),!this.data._fullScreen&&this.hasAttribute("fullScreen")&&this.removeAttribute("fullScreen"),this.data._fullScreen&&!this.hasAttribute("fullScreen")&&this.setAttribute("fullScreen","")),this.data._isLoading&&(this.setAttribute("data-status",StatuspageDictionary.StatusEnums.loading),this.hasAttribute("fullScreen")||this.setAttribute("fullScreen","")))}get isLoading(){return this.data._isLoading}set fullScreen(t){"boolean"==typeof t?(this.data._fullScreen=t,this.data._isFullScreenSet=!0,this.data._fullScreen?this.hasAttribute("fullScreen")||this.setAttribute("fullScreen",""):this.removeAttribute("fullScreen")):console.error(`'${t}' is not a boolean.`)}get fullScreen(){return this.data._fullScreen}set dataStatus(t){"string"==typeof t&&t in StatuspageDictionary.StatusEnums?(this.data._status=t,this.dataset.status=t,this.hasAttribute("status")&&this.removeAttribute("status"),this.hasAttribute("data-status")||this.setAttribute("data-status",this.dataset.status),StatuspageHTMLElements.SetThemeColor(this.data._status),null==this.data._fullScreen&&(this.data._fullScreen=!1)):"string"==typeof t?console.error(`'${t}' is not a valid status.`):console.error(`'${t}' is not a string.`)}get dataStatus(){return this.data._status}set baseUrl(t){if("string"==typeof t)if(URL.canParse(this.data._urlPath,t)){var s=new URL(this.data._urlPath,t);this.data._baseUrl=s.origin,this.data._url=s.href,this.data._isLoadingEnabled=!0,"url"in this.dataset||(this.dataset.url=this.data._baseUrl)}else console.error(`${t} is an invalid URL`);else null!=t&&null!=t||(this.data._baseUrl=null,this.data._url=null)}get baseUrl(){return this.data._baseUrl}get url(){return this.data._url}constructor(){super(),this.data={_urlPath:"/api/v2/status.json",_baseUrl:null,_url:null,_fullScreen:null,_isLoading:!1,_status:void 0,_isFullScreenSet:!1,_isLoadingEnabled:!1}}connectedCallback(){console.log(`Starting ${StatuspageWebComponents.Status.is}`),this.isInSummary&&null!=this.summaryJson&&"status"in this.summaryJson&&"indicator"in this.summaryJson.status&&(this.dataStatus=this.summaryJson.status.indicator),StatuspageHTMLElements.UpdateUrlTags(location.href),null!=this.baseUrl&&(navigator.onLine?(this.isLoading=!0,this.fetchStatus(),delete this.dataset.url,this.isLoading=!1):this.setError()),console.log(this.toString()),console.log(`Finished ${StatuspageWebComponents.Status.is}`)}attributeChangedCallback(t,s,e){"status"==t&&null!=e&&e in StatuspageDictionary.StatusEnums&&(this.dataStatus=e),"data-status"==t&&null!=e&&e in StatuspageDictionary.StatusEnums&&(this.data._status=e,StatuspageHTMLElements.SetThemeColor(e)),"data-url"==t&&"null"!=e&&(this.baseUrl=e),"fullscreen"!=t||this.data._isFullScreenSet||this.isLoading||(this.fullScreen=null!=e)}fetchStatus(){return new Promise(((t,s)=>{console.log(this.url),navigator.onLine&&null!=this.url?fetch(this.url).then((t=>t.json())).then((s=>{"status"in s&&"indicator"in s.status&&(this.dataStatus=s.status.indicator),"page"in s&&"name"in s.page&&StatuspageHTMLElements.SetTitle(s.page.name,StatuspageDictionary.PathNames.Status),t()})).catch((t=>{this.setError(),s(t)})):navigator.onLine?null==this.url&&console.error(`this.url is ${this.url}`):console.log("Browser is offline")}))}setError(){this.dataStatus=StatuspageDictionary.StatusEnums.error,this.fullScreen=!0}toString(){return this.outerHTML.toString()}static get is(){return StatuspageDictionary.HTMLTags.StatuspageStatus}static toHTML(t,s=!1){var e=document.createElement(this.is,{is:this.is});return e.setAttribute("data-status",t),s&&e.setAttribute("fullScreen",""),e}static staticHTML(t=null,s=null,e=!1){var a={};return null!=t&&(a["data-status"]=t),null!=s&&(a["data-url"]=s),e&&(a.fullScreen=null),`<${this.is} ${StatuspageStaticHTML.GenerateAttributes(a)}></${this.is}>`}}}static get Component(){return class extends HTMLElement{set dataStatus(t){"string"==typeof t&&(this.dataset.status=t)}get dataStatus(){return this.dataset.status}set dataMessage(t){"string"==typeof t&&(this.dataset.message=t)}get dataMessage(){return this.dataset.message}constructor(){super()}toString(){return this.outerHTML.toString()}static get is(){return StatuspageDictionary.HTMLTags.StatuspageComponent}static staticHTML(t,s){var e={"data-status":t,"data-message":s};return`<${this.is} ${StatuspageStaticHTML.GenerateAttributes(e)}></${this.is}>`}}}static get Components(){return class extends HTMLElement{constructor(){super()}connectedCallback(){console.log(`Starting ${StatuspageWebComponents.Components.is}`),this.appendChild(StatuspageWebComponents.Loading.toHTML()),this.hasAttribute("data-json")?this.parseJson(JSON.parse(this.getAttribute("data-json"))):this.hasAttribute("data-url")?this.fetchComponents(this.getAttribute("data-url")):this.replaceWith(StatuspageWebComponents.Error.toHTML()),console.log(`Finished ${StatuspageWebComponents.Components.is}`)}fetchComponents(t){return new Promise(((s,e)=>{var a="/"==t.slice(-1)?t.substring(0,t.length-1):t;fetch(a+"/api/v2/components.json").then((t=>t.json())).then((t=>{this.parseJson(t),s()})).catch((t=>e(t)))}))}parseJson(t){for(var s=StatuspageHTMLElements.ComponentsHTMLElement(t),e=0;e<s.length;e++)this.append(s[e]);this.removeChild(this.firstElementChild)}toString(){return this.outerHTML.toString()}static get is(){return StatuspageDictionary.HTMLTags.StatuspageComponents}}}static get Incidents(){return class extends StatuspageWebComponents.CustomHTMLElement{static get observedAttributes(){return["data-json","data-url"]}set dataJson(t){"string"==typeof t&&(this._dataJson=JSON.parse(t)),"object"==typeof t&&(this._dataJson=t),null!=this._dataJson&&(this._incidentsElements=StatuspageHTMLElements.IncidentsHTMLElements(this._dataJson,this.previousDays,!1,this.showMaintenance),this.replaceWith(this._incidentsElements))}get dataJson(){return this._dataJson}set baseUrl(t){if("string"==typeof t&&URL.canParse(this._urlPath,t)){var s=new URL(this._urlPath,t);this._baseUrl=s.origin,this._url=s.href,this.dataset.url||(this.dataset.url=this._baseUrl)}}get baseUrl(){return this._baseUrl}get url(){return this._url}get incidentElements(){return this._incidentsElements}set showMaintenance(t){"boolean"==typeof t&&(this._showMaintenance=t)}get showMaintenance(){return this._showMaintenance}set previousDays(t){"number"==typeof t&&(this._previousDays=t)}get previousDays(){return this._previousDays}constructor(){super(),this._urlPath="/api/v2/incidents.json",this._baseUrl=null,this._url=null,this._previousDays=7,this._showMaintenance=!1,this._dataJson=null,this._incidentsElements=null}connectedCallback(){console.log(`Starting ${StatuspageWebComponents.Incidents.is}`),this.isInSummary&&null!=this.summaryJson&&(this.dataJson=this.summaryJson),null!=this.url&&this.fetchIncidents(),null!=this.incidentElements&&this.replaceWith(this.incidentElements),console.log(`Finished ${StatuspageWebComponents.Incidents.is}`)}attributeChangedCallback(t,s,e){"data-json"==t&&null!=e&&(this.dataJson=e),"data-url"==t&&null!=e&&(this.baseUrl=e)}fetchIncidents(){return new Promise(((t,s)=>{navigator.onLine&&null!=this.url&&fetch(this.url).then((t=>t.json())).then((s=>{this.dataJson=s,t()})).catch((t=>s(t)))}))}toString(){return this.outerHTML.toString()}static get is(){return StatuspageDictionary.HTMLTags.StatuspageIncidents}}}static get Summary(){return class extends HTMLElement{static get observedAttributes(){return["data-url","data-single-request"]}set isSingleRequest(t){"boolean"==typeof t&&(this._isSingleRequest=t,this.dataset.singleRequest||(this.dataset.singleRequest=t))}get isSingleRequest(){return this._isSingleRequest}set baseUrl(t){if("string"==typeof t){if(URL.canParse(this._urlPath,t)){var s=new URL(this._urlPath,t);this._baseUrl=s.origin,this._url=s.href}this.dataset.url||(this.dataset.url=this.baseUrl)}}get baseUrl(){return this._baseUrl}get url(){return this._url}constructor(){super(),this._urlPath="/api/v2/summary.json",this._baseUrl=null,this._url=null,this._isLoading=!1,this._isSingleRequest=!0,this._dataJson=null}connectedCallback(){console.log(`Starting ${StatuspageWebComponents.Summary.is}`),this.singleRequest=!0,this.appendChild(StatuspageWebComponents.Loading.toHTML()),this.status=document.createElement(StatuspageWebComponents.Status.is,{is:StatuspageWebComponents.Status.is}),this.incidents=document.createElement(StatuspageWebComponents.Incidents.is,{is:StatuspageWebComponents.Incidents.is}),this.incidents.previousDays=this.isSingleRequest?365:7,this.incidents.showMaintenance=!1,null!=this.baseUrl&&navigator.onLine?this.isSingleRequest?this.fetchSummary():(this.status.baseUrl=this.baseUrl,this.incidents.baseUrl=this.baseUrl,this.firstElementChild.replaceWith(this.status),this.appendChild(this.incidents)):this.replaceWith(StatuspageWebComponents.Error.toHTML()),console.log(`Finished ${StatuspageWebComponents.Summary.is}`)}attributeChangedCallback(t,s,e){"data-url"==t&&(this.baseUrl=e),"data-single-request"==t&&null!=e&&(this.isSingleRequest="true"===this.dataset.singleRequest.toLowerCase())}fetchSummary(){return new Promise(((t,s)=>{fetch(this.url).then((t=>t.json())).then((s=>{this.parseJson(s),t()})).catch((t=>{s(t)}))}))}async parseJson(t){"status"in t?(this.status.dataStatus=t.status.indicator,this.incidents.dataJson=t,this.firstElementChild.replaceWith(this.status),this.appendChild(this.incidents),"page"in t&&"name"in t.page&&(StatuspageHTMLElements.SetTitle(t.page.name,StatuspageDictionary.PathNames.Index),StatuspageHTMLElements.SetDescription(t.page.name))):this.firstElementChild.replaceWith(StatuspageWebComponents.Loading.toHTML())}toString(){return this.outerHTML.toString()}static get is(){return StatuspageDictionary.HTMLTags.StatuspageSummary}}}}