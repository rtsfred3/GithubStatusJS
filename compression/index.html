<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">

        <meta name="author" content="rtsfred3">
        <meta name="application-name" content="(Unofficial) Cloudflare Status">
        <meta name="theme-color" content="#53C68C">
        <meta name="description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta name="keywords" content="Cloudflare Statuspage, Cloudflare Status Page, Cloudflare Status, Statuspage, Status">
        
        <!-- <meta itemprop="name" content="(Unofficial) Cloudflare Status">
        <meta itemprop="description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta itemprop="image" content="http://spstat.us/img/status/lowres/min/status-min-good.png"> -->

        <meta property="og:site_name" content="(Unofficial) Cloudflare Statuspage">
        <meta property="og:title" content="(Unofficial) Cloudflare Status">
        <meta property="og:description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://spstat.us/">
        <meta property="og:image" content="https://spstat.us/img/status/lowres/min/status-min-good.png">
        <meta property="og:image:type" content="image/png" />
        <meta property="og:image:width" content="300" />
        <meta property="og:image:height" content="300" />
        
        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="(Unofficial) Cloudflare Status">
        <meta name="twitter:description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta name="twitter:image" content="https://spstat.us/img/status/lowres/min/status-min-good.webp">
        
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-title" content="(Unofficial) Cloudflare Status">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="#53C68C">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0.0" />
        <meta name="HandheldFriendly" content="true" />

        <link rel="canonical" href="https://spstat.us/" />
        
        <link rel="icon" type="image/x-icon" href="https://spstat.us/favicon.ico">
        <link rel="apple-touch-icon" sizes="144x144" href="https://spstat.us/img/maskable/144px.png">

        <link rel="dns-prefetch" href="//www.cloudflarestatus.com/" />
        <link rel="preconnect" href="//www.cloudflarestatus.com/">

        <meta name="referrer" content="no-referrer-when-downgrade">
        <meta name="Cross-Origin-Opener-Policy" content="same-origin-allow-popups">

        <title>Compression Testing</title>

        <!-- <script>
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./sw.js').then(function(reg) {
                    console.log(reg);
                }).catch(function(err) {
                    console.log(err);
                });
            }
        </script> -->

        <!-- <link rel="stylesheet" href="../styling/github.amp.css"> -->
        <!-- <link rel="stylesheet" href="../styling/github.css"> -->
        <!-- <link rel="stylesheet" href="../styling/messages.css"> -->

        <script src="../js/StatuspageDictionary.js"></script>
        <script src="../js/StatuspageStaticHTML.js"></script>
        <script src="../js/Compression.js"></script>
        <script src="../js/StatuspageHTML.js"></script>

        <!-- <script src="../js/Compression.js"></script> -->

        <style>
            :root{--good:#339966;--none:var(--good);--minor:#DBAB09;--major:#E25D10;--critical:#DC3545;--maintenance:#0366D6;--loading:#4F93BD;--unavailable:var(--loading);--error:#646464;--font:var(--error);--incident-good:var(--good);--incident-none:#000000;--incident-minor:#F1C40F;--incident-major:#FF9900;--incident-critical:#990000;--incident-maintenance:var(--maintenance);--incident-error:var(--error);--good-text:"good";--none-text:var(--good-text);--minor-text:"minor";--major-text:"major";--critical-text:"critical";--maintenance-text:"maintenance";--loading-text:"loading";--unavailable-text:"unavailable";--error-text:"error"}*{margin:0;padding:0}body{font-family:arial}[capitalize]{text-transform:capitalize}.fullScreen,.statuspage-status:has(.fullScreen),:has(.fullScreen),[fullScreen],statuspage-error,statuspage-loading,statuspage-unavailable{height:100vh}.statuspage-status:not(.fullScreen),statuspage-component,statuspage-status{height:240px}.statuspage-status,statuspage-component,statuspage-error,statuspage-loading,statuspage-status,statuspage-unavailable{width:100vw;text-align:center;justify-content:center;align-items:center;display:block;display:flex;font-size:48pt}.statuspage-status[data-status]::before,statuspage-error::before,statuspage-loading::before,statuspage-status[data-status]::before,statuspage-unavailable::before{content:attr(data-status);text-transform:uppercase;font-weight:700;color:#fff}statuspage-component[data-message]::before{content:attr(data-message);font-weight:700;color:#fff}.statuspage-status[data-status=good]::before,.statuspage-status[data-status=none]::before,statuspage-status[data-status=good]::before,statuspage-status[data-status=none]::before{content:var(--good-text)}statuspage-loading::before{content:var(--loading-text)}statuspage-unavailable::before{content:var(--unavailable-text)}statuspage-error::before{content:var(--error-text)}@media only screen and (max-height:400px){.statuspage-status:not(.fullScreen),statuspage-status{height:45vh}}@media only screen and (max-width:320px) and (max-height:320px){.statuspage-status:not(.fullScreen),statuspage-status{height:100vh}}@media only screen and (min-width:2048px) and (min-height:1080px){.statuspage-status:not(.fullScreen),statuspage-status{height:30vh}.statuspage-status,statuspage-error,statuspage-loading,statuspage-status,statuspage-unavailable{font-size:12em}}@media only screen and (((min-width:2100px) and (min-height:1100px)) or ((min-width:3000px) and (min-height:2000px))){.statuspage-status:not(.fullScreen),statuspage-status{height:40vh}.statuspage-status,statuspage-error,statuspage-loading,statuspage-status,statuspage-unavailable{font-size:16em}}[data-status=good],[data-status=none]{background-color:var(--none)}[data-status=minor]{background-color:var(--minor)}[data-status=major]{background-color:var(--major)}[data-status=critical]{background-color:var(--critical)}[data-status=maintenance]{background-color:var(--maintenance);font-weight:500}[data-status=loading],[data-status=unavailable],statuspage-loading,statuspage-unavailable{background-color:var(--loading)}[data-status=error],statuspage-error{background-color:var(--error)}@media only screen and (min-width:351px) and (max-width:450px){[data-status=maintenance]{font-size:36pt}}@media only screen and (min-width:251px) and (max-width:350px){[data-status=maintenance]{font-size:30pt}}@media only screen and (min-width:151px) and (max-width:250px){[data-status=maintenance]{font-size:20pt}}

            .messages-empty{padding:3vh 7.5vw 0;color:var(--font)}.messages-empty-all-good{font-size:36pt;font-weight:600;margin-bottom:2.5vh}.messages-empty-body{font-size:9pt;font-weight:500}.messages{margin:1.5em 0;padding:0}.message-body{font-size:11pt;margin:1em 2.5vw}.date{font-size:9pt!important;color:var(--font)}[data-impact]{height:45px;font-size:14pt;color:#f8f8f8}[data-impact]::before{content:attr(data-impact)}[data-impact-body]::before{content:attr(data-impact-body);text-transform:capitalize}[data-impact=error],[data-impact=good]{width:120px}[data-impact=maintenance],[data-impact=minor],[data-impact=none]{width:200px}[data-impact=good]{background-color:var(--incident-good)}[data-impact=none]{background-color:var(--incident-none)}[data-impact=minor]{background-color:var(--incident-minor)}[data-impact=major]{width:280px;background-color:var(--incident-major)}[data-impact=critical]{width:360px;background-color:var(--incident-critical)}[data-impact=maintenance]{background-color:var(--incident-maintenance)}[data-impact=error]{background-color:var(--incident-error)}@media only screen and (max-width:850px){[data-impact=good]{width:20vw}[data-impact=maintenance],[data-impact=minor],[data-impact=none]{width:40vw}[data-impact=major]{width:60vw}[data-impact=critical]{width:80vw}[data-impact=error]{width:50vw}.message-body{margin:3vh 4vw}}@media only screen and (max-width:400px){.message-body{margin:3vh 7vw}}@media only screen and (max-width:320px) and (max-height:320px){.messages{display:none;height:0}}@media only screen and (min-width:2048px) and (min-height:1080px){.message-body,[data-impact]{font-size:2.5em}[data-impact=good]{width:20vw}[data-impact=maintenance],[data-impact=minor],[data-impact=none]{width:40vw}[data-impact=major]{width:60vw}[data-impact=critical]{width:80vw}[data-impact=error]{width:50vw}[data-impact]{height:2em}.date{font-size:.75em!important}}@media (min-width:2100px) and (min-height:1100px){[data-impact]{height:1.75em;font-size:3.5em}.message-body{font-size:3em}.messages{margin:3em 0}}@media (min-width:3000px) and (min-height:2000px){[data-impact]{height:1.75em;font-size:5em}.message-body{font-size:4em}}[data-impact]{padding-right:.5em;vertical-align:middle;display:table-cell!important;text-align:end}
        </style>
    </head>
    <body id="body">
        <form name="uploadForm">
            <input type="file" id="gzFiles" accept="application/gzip" />
            <!-- <label for="statusElement">Status:</label> -->
            <!-- <output id="statusElement">unavailable</output> -->
            <div><pre id="fileBody"></pre></div>
            <!-- <input type="submit" value="Send file" /> -->
        </form>

        <script>
            const uploadInput = document.getElementById("gzFiles");
            const statusElement = document.getElementById("statusElement");
            const fileBody = document.getElementById("fileBody");

            const sizeableMbString = Compression.mbRandomString.repeat(10);

            let sampleTextFile = Compression.SampleTextFile(50, '_random.txt');

            const compressedStringGzipAsync = Compression.Compress(sizeableMbString, 'gzip');
            const compressedStringDeflateAsync = Compression.Compress(sizeableMbString, 'deflate');

            compressedStringGzipAsync.then(t => console.log(t.length));
            compressedStringDeflateAsync.then(t => console.log(t.length));

            const randString = Compression.kbRandomString;
            var textFile = Compression.TextFile(randString, '_random.txt');

            // Compression.DownloadFile(textFile);
            // Compression.CompressFile(textFile).then(async (t) => {
            //     const decompressedFile = await Compression.DecompressFile(t, '_random2.txt', 'text/plain');
            //     Compression.DownloadFile(decompressedFile);
            // })

            // Compression.Compress('0'.repeat(1000 * 1000)).then(t => console.log(t));

            uploadInput.addEventListener("change", () => {
                console.log(uploadInput.files);
                for (const file of uploadInput.files) {
                    file.arrayBuffer().then(ab => {
                        console.log(ab)
                        var uint8Arr = new Uint8Array(ab);
                        // var hexArr = uint8Arr.toBase64();
                        // var intArr = Array.from(uint8Arr);
                        // var arr = intArr.map(t => t.toString(16));
                        console.log(uint8Arr);
                        // .toString(16);
                    });

                    const readable = file.stream().getReader().read();
                    readable.then(r => console.log(r.value))

                    Compression.DecompressFile(file, 'status.json', 'application/json', 'gzip').then(t => {
                        // Compression.DownloadFile(t);
                        t.text().then(text => {
                            // let json = JSON.parse(text);

                            let xmlFile = new File([text], 'fileName.xml', { 'type': 'text/plain' });
                            Compression.DownloadFile(xmlFile);

                            let xml = (new DOMParser()).parseFromString(text, 'text/xml');
                            console.log(xml);

                            fileBody.textContent = text;// JSON.stringify(json, null, 2);

                            // if ('status' in json && 'indicator' in json['status']) {
                            //     statusElement.textContent = json['status']['indicator'].toUpperCase();
                            // }
                        });
                    });
                }
            }, false);
        </script>
    </body>
</html>
