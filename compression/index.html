<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">

        <meta name="author" content="rtsfred3">
        <meta name="application-name" content="(Unofficial) Cloudflare Status">
        <meta name="theme-color" content="#53C68C">
        <meta name="description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta name="keywords" content="Cloudflare Statuspage, Cloudflare Status Page, Cloudflare Status, Statuspage, Status">
        
        <!-- <meta itemprop="name" content="(Unofficial) Cloudflare Status">
        <meta itemprop="description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta itemprop="image" content="http://spstat.us/img/status/lowres/min/status-min-good.png"> -->

        <meta property="og:site_name" content="(Unofficial) Cloudflare Statuspage">
        <meta property="og:title" content="(Unofficial) Cloudflare Status">
        <meta property="og:description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://spstat.us/">
        <meta property="og:image" content="https://spstat.us/img/status/lowres/min/status-min-good.png">
        <meta property="og:image:type" content="image/png" />
        <meta property="og:image:width" content="300" />
        <meta property="og:image:height" content="300" />
        
        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="(Unofficial) Cloudflare Status">
        <meta name="twitter:description" content="A website to monitor a website monitored by Cloudflare Status.">
        <meta name="twitter:image" content="https://spstat.us/img/status/lowres/min/status-min-good.webp">
        
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-title" content="(Unofficial) Cloudflare Status">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="#53C68C">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0.0" />
        <meta name="HandheldFriendly" content="true" />

        <!-- <link rel="canonical" href="https://spstat.us/" /> -->
        
        <link rel="icon" type="image/x-icon" href="https://spstat.us/favicon.ico">
        <link rel="apple-touch-icon" sizes="144x144" href="https://spstat.us/img/maskable/144px.png">

        <link rel="dns-prefetch" href="//www.cloudflarestatus.com/" />
        <link rel="preconnect" href="//www.cloudflarestatus.com/">

        <meta name="referrer" content="no-referrer-when-downgrade">
        <meta name="Cross-Origin-Opener-Policy" content="same-origin-allow-popups">

        <title>Compression Testing</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>

        <script src="../js/StatuspageDictionary.js"></script>
        <script src="../js/StatuspageStaticHTML.js"></script>
        <script src="../js/Utils.js"></script>
        <script src="../js/Compression.js"></script>
        <script src="../js/StatuspageHTML.js"></script>

        <!-- <script src="../js/Compression.js"></script> -->

        <style>
            :root{--good:#339966;--none:var(--good);--minor:#DBAB09;--major:#E25D10;--critical:#DC3545;--maintenance:#0366D6;--loading:#4F93BD;--unavailable:var(--loading);--error:#646464;--font:var(--error);--incident-good:var(--good);--incident-none:#000000;--incident-minor:#F1C40F;--incident-major:#FF9900;--incident-critical:#990000;--incident-maintenance:var(--maintenance);--incident-error:var(--error);--good-text:"good";--none-text:var(--good-text);--minor-text:"minor";--major-text:"major";--critical-text:"critical";--maintenance-text:"maintenance";--loading-text:"loading";--unavailable-text:"unavailable";--error-text:"error"}*{margin:0;padding:0}body{font-family:arial}[capitalize]{text-transform:capitalize}.fullScreen,.statuspage-status:has(.fullScreen),:has(.fullScreen),[fullScreen],statuspage-error,statuspage-loading,statuspage-unavailable{height:100vh}.statuspage-status:not(.fullScreen),statuspage-component,statuspage-status{height:240px}.statuspage-status,statuspage-component,statuspage-error,statuspage-loading,statuspage-status,statuspage-unavailable{width:100vw;text-align:center;justify-content:center;align-items:center;display:block;display:flex;font-size:48pt}.statuspage-status[data-status]::before,statuspage-error::before,statuspage-loading::before,statuspage-status[data-status]::before,statuspage-unavailable::before{content:attr(data-status);text-transform:uppercase;font-weight:700;color:#fff}statuspage-component[data-message]::before{content:attr(data-message);font-weight:700;color:#fff}.statuspage-status[data-status=good]::before,.statuspage-status[data-status=none]::before,statuspage-status[data-status=good]::before,statuspage-status[data-status=none]::before{content:var(--good-text)}statuspage-loading::before{content:var(--loading-text)}statuspage-unavailable::before{content:var(--unavailable-text)}statuspage-error::before{content:var(--error-text)}@media only screen and (max-height:400px){.statuspage-status:not(.fullScreen),statuspage-status{height:45vh}}@media only screen and (max-width:320px) and (max-height:320px){.statuspage-status:not(.fullScreen),statuspage-status{height:100vh}}@media only screen and (min-width:2048px) and (min-height:1080px){.statuspage-status:not(.fullScreen),statuspage-status{height:30vh}.statuspage-status,statuspage-error,statuspage-loading,statuspage-status,statuspage-unavailable{font-size:12em}}@media only screen and (((min-width:2100px) and (min-height:1100px)) or ((min-width:3000px) and (min-height:2000px))){.statuspage-status:not(.fullScreen),statuspage-status{height:40vh}.statuspage-status,statuspage-error,statuspage-loading,statuspage-status,statuspage-unavailable{font-size:16em}}[data-status=good],[data-status=none]{background-color:var(--none)}[data-status=minor]{background-color:var(--minor)}[data-status=major]{background-color:var(--major)}[data-status=critical]{background-color:var(--critical)}[data-status=maintenance]{background-color:var(--maintenance);font-weight:500}[data-status=loading],[data-status=unavailable],statuspage-loading,statuspage-unavailable{background-color:var(--loading)}[data-status=error],statuspage-error{background-color:var(--error)}@media only screen and (min-width:351px) and (max-width:450px){[data-status=maintenance]{font-size:36pt}}@media only screen and (min-width:251px) and (max-width:350px){[data-status=maintenance]{font-size:30pt}}@media only screen and (min-width:151px) and (max-width:250px){[data-status=maintenance]{font-size:20pt}}

            .messages-empty{padding:3vh 7.5vw 0;color:var(--font)}.messages-empty-all-good{font-size:36pt;font-weight:600;margin-bottom:2.5vh}.messages-empty-body{font-size:9pt;font-weight:500}.messages{margin:1.5em 0;padding:0}.message-body{font-size:11pt;margin:1em 2.5vw}.date{font-size:9pt!important;color:var(--font)}[data-impact]{height:45px;font-size:14pt;color:#f8f8f8}[data-impact]::before{content:attr(data-impact)}[data-impact-body]::before{content:attr(data-impact-body);text-transform:capitalize}[data-impact=error],[data-impact=good]{width:120px}[data-impact=maintenance],[data-impact=minor],[data-impact=none]{width:200px}[data-impact=good]{background-color:var(--incident-good)}[data-impact=none]{background-color:var(--incident-none)}[data-impact=minor]{background-color:var(--incident-minor)}[data-impact=major]{width:280px;background-color:var(--incident-major)}[data-impact=critical]{width:360px;background-color:var(--incident-critical)}[data-impact=maintenance]{background-color:var(--incident-maintenance)}[data-impact=error]{background-color:var(--incident-error)}@media only screen and (max-width:850px){[data-impact=good]{width:20vw}[data-impact=maintenance],[data-impact=minor],[data-impact=none]{width:40vw}[data-impact=major]{width:60vw}[data-impact=critical]{width:80vw}[data-impact=error]{width:50vw}.message-body{margin:3vh 4vw}}@media only screen and (max-width:400px){.message-body{margin:3vh 7vw}}@media only screen and (max-width:320px) and (max-height:320px){.messages{display:none;height:0}}@media only screen and (min-width:2048px) and (min-height:1080px){.message-body,[data-impact]{font-size:2.5em}[data-impact=good]{width:20vw}[data-impact=maintenance],[data-impact=minor],[data-impact=none]{width:40vw}[data-impact=major]{width:60vw}[data-impact=critical]{width:80vw}[data-impact=error]{width:50vw}[data-impact]{height:2em}.date{font-size:.75em!important}}@media (min-width:2100px) and (min-height:1100px){[data-impact]{height:1.75em;font-size:3.5em}.message-body{font-size:3em}.messages{margin:3em 0}}@media (min-width:3000px) and (min-height:2000px){[data-impact]{height:1.75em;font-size:5em}.message-body{font-size:4em}}[data-impact]{padding-right:.5em;vertical-align:middle;display:table-cell!important;text-align:end}
        </style>
    </head>
    <body id="body">
        <div class="container">
            <form name="uploadForm">
                <div class="mb-3">
                    <label for="uncompressedFile" class="form-label">File to Compress</label>
                    <input class="form-control" type="file" id="uncompressedFile" multiple>
                </div>
            </form>

            <form name="uploadForm">
                <div class="mb-3">
                    <label for="gzFiles" class="form-label">File to Decompress</label>
                    <input class="form-control" type="file" id="gzFiles" accept="application/gzip">
                </div>
            </form>

            <form name="decompressJson">
                <div class="mb-3">
                    <label for="gzJsonFiles" class="form-label">JSON File to Decompress</label>
                    <input class="form-control" type="file" id="gzJsonFiles" accept="application/gzip">
                </div>
            </form>
        </div>

        <div>
            <pre id="fileBody" style="white-space: pre-wrap; word-break: keep-all; overflow-x: auto;"></pre>
        </div>

        <div class="container">
            <div id="downloadFileRandomButtons"></div>
            <div id="downloadFileRepeatButtons"></div>
        </div>

        <script>
            const downloadFileRandomButtons = document.getElementById('downloadFileRandomButtons');
            const downloadFileRepeatButtons = document.getElementById('downloadFileRepeatButtons');

            for (let fileSize of [32, 64, 128, 256, 512, 1024, 2048]) {
                downloadFileRandomButtons.innerHTML += `<button type="button" class="btn btn-primary" onclick="downloadFile(${fileSize})">Download ${fileSize}MB Unique File</button>`;
                downloadFileRepeatButtons.innerHTML += `<button type="button" class="btn btn-primary" onclick="downloadRepeatingFile(${fileSize})">Download ${fileSize}MB Repeat File</button>`;
            }

            function downloadFile(fileSizeInMb) {
                let sampleTextFile = Utils.SampleTextFile(fileSizeInMb);
                Compression.CompressFileAsync(sampleTextFile).then(f => Compression.DownloadFile(f));
            }

            function downloadRepeatingFile(fileSizeInMb) {
                let sampleTextFile = Utils.SampleTextFileRepeating(fileSizeInMb);
                Compression.CompressFileAsync(sampleTextFile).then(f => Compression.DownloadFile(f));
            }
        </script>

        <script>
            // const host = document.querySelector("#body");
            // const shadow = host.attachShadow({ mode: "open" });
            
            const statusWebComponent = document.createElement(StatuspageWebComponents.Status.is, { is: StatuspageWebComponents.Status.is });
            statusWebComponent.baseUrl = 'https://www.cloudflarestatus.com';
            statusWebComponent.hidden = true;

            // host.appendChild(statusWebComponent);

            // console.log(Utils.randomUppercaseLetter);
            // console.log(Utils.randomUppercaseLetter);
            // console.log(Utils.randomUppercaseLetter);

            // console.log(Utils.randomLowercaseLetter);
            // console.log(Utils.randomLowercaseLetter);
            // console.log(Utils.randomLowercaseLetter);

            // console.log(Utils.randomNumber);
            // console.log(Utils.randomNumber);
            // console.log(Utils.randomNumber);

            // var start = Date.now();
            
            // var tmp = Array(512).fill(Utils.mbRandomAlphanumericString).join('');
            // console.log(tmp.length);

            // console.log(`${Date.now() - start} ms`);

            // console.log(Utils.alphanumeric);
            // console.log(Utils.randomAlphanumeric);
            // console.log(Utils.kbRandomAlphanumericString);
            // console.log(Utils.mbRandomAlphanumericString);
        </script>

        <script>
            const uploadCompressedJson = document.getElementById("gzJsonFiles");
            const uploadCompressedInput = document.getElementById("gzFiles");
            const uploadUncompressedInput = document.getElementById("uncompressedFile");
            const statusElement = document.getElementById("statusElement");
            const fileBody = document.getElementById("fileBody");

            // const statuspageDictionaryObj = Utils.ToObject(StatuspageDictionary);
            // Compression.DownloadFile(Compression.JsonFile(statuspageDictionaryObj, 'StatuspageDictionary.json'));
            // Compression.CompressAndDownloadJson(statuspageDictionaryObj, 'StatuspageDictionary.json');

            // var tmp = Array.from({ length: (4294967295 / (1000 * 1000)) }, (_) => 0);

            // const sizeableMbString = Utils.mbString.repeat(50);
            // const mbStringFile = Utils.TextFile(sizeableMbString, '50MB_Repeat.txt');
            // Compression.CompressFileAsync(mbStringFile).then(f => Compression.DownloadFile(f));
            // const mbStringFile = new File([sizeableMbString], '50MB_Repeat.txt', { 'type': 'text/plain' });

            // let sampleTextFile1 = Utils.SampleTextFile(1);
            // let sampleTextFile2 = Utils.SampleTextFile(50);
            // Compression.CompressFileAsync(sampleTextFile1).then(f => Compression.DownloadFile(f));
            // Compression.CompressFileAsync(sampleTextFile2).then(f => Compression.DownloadFile(f));

            // Compression.CompressAsync(sizeableMbString).then(f => Compression.Decompress(f).then(t => console.log(t)));
            // Compression.CompressAsync(sizeableMbString).then(f => Compression.Decompress(f.buffer).then(t => console.log(t)));
            // Compression.CompressAsync(sizeableMbString).then(f => console.log(Compression.Decompress(f.buffer)));

            // const compressedStringGzipAsync = Compression.Compress(sizeableMbString, 'gzip');
            // const compressedStringDeflateAsync = Compression.Compress(sizeableMbString, 'deflate');

            // compressedStringGzipAsync.then(t => {
            //     console.log(t.length);
            //     Compression.DownloadFile(compressedFile);
            // });

            // Compression.Compress('0'.repeat(1000 * 1000)).then(t => console.log(t));

            async function UploadCompressedJsonAsync() {
                const jsonFile = await Compression.DecompressFileAsync(uploadCompressedJson.files[0], 'application/json');
                const jsonFromFile = JSON.parse(await jsonFile.text());

                localStorage.setItem(jsonFile.name, JSON.stringify(jsonFromFile));

                console.log(jsonFromFile);

                uploadCompressedJson.value = "";
            }

            uploadUncompressedInput.addEventListener("change", () => {
                for (const file of uploadUncompressedInput.files) {
                    Compression.CompressFileAsync(file).then(f => Compression.DownloadFile(f));
                }
            }, false);

            uploadCompressedInput.addEventListener("change", () => {
                for (const file of uploadCompressedInput.files) {
                    Compression.DecompressFileAsync(file, '').then(f => {
                        Compression.DownloadFile(f);

                        f.text().then(text => { 
                            console.log(text);
                            // fileBody.innerText = text;
                        });
                    });
                }
            }, false);

            uploadCompressedJson.onchange = UploadCompressedJsonAsync;
        </script>
    </body>
</html>
